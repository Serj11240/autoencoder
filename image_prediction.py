# -*- coding: utf-8 -*-
"""Image_prediction

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1FTFGK5En-BGaqVInUApZwU1mMCdg6BOc
"""

import pickle
import numpy as np
import cv2

#load model with trained weights for image autoencodered generation
pickled_model = pickle.load(open('Autoencoder_model.pkl', 'rb'))

def check_image_output(file_path):
  '''
  Function takes image from a given path.
  Returns original and autoencoded/"predicted" image.
  '''
  #read original image
  img = cv2.imread(file_path)

  #prepare image to pass through model
  #resize the original image to dimentions of the training dataset
  resized = cv2.resize(img, (img_width, img_height), interpolation = cv2.INTER_AREA)
  #create new image by passing through a model
  pred = pickled_model.predict(np.array([resized]))
  #matplotlib takes range of [0..1] for floats and [0..255] for integers

  #image plot to compare results
  plt.figure(figsize=(12, 12))  
  ax = plt.subplot(2, 1, 1)
  plt.axis("off")
  plt.imshow(img)
 
  ax = plt.subplot(2, 1, 2)
  plt.imshow(pred[0])
  plt.axis("off")

if __name__=='__main__':

  #pick an image for prediction
  file_path = input('Provide full file location with file name: ')
  #autoencoding image
  check_image_output(file_path)

